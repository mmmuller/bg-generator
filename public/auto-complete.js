var wbAutoComplete=function(e){if(document.querySelector){var n={selector:0,source:0,minChars:3,delay:150,offsetLeft:0,offsetTop:1,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="wb-autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(e,t,o){}};for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);for(var o="object"==typeof n.selector?[n.selector]:document.querySelectorAll(n.selector),s=0;s<o.length;s++){var c=o[s];c.sc=document.createElement("div"),c.sc.className="wb-autocomplete-suggestions "+n.menuClass,c.autocompleteAttr=c.getAttribute("autocomplete"),c.setAttribute("autocomplete","off"),c.cache={},c.last_val="",c.updateSC=function(e,t){var o=c.getBoundingClientRect();if(c.sc.style.left=Math.round(o.left+(window.pageXOffset||document.documentElement.scrollLeft)+n.offsetLeft)+"px",c.sc.style.top=Math.round(o.bottom+(window.pageYOffset||document.documentElement.scrollTop)+n.offsetTop)+"px",c.sc.style.width=Math.round(o.right-o.left)+"px",!e&&(c.sc.style.display="block",c.sc.maxHeight||(c.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(c.sc,null):c.sc.currentStyle).maxHeight)),c.sc.suggestionHeight||(c.sc.suggestionHeight=c.sc.querySelector(".wb-autocomplete-suggestion").offsetHeight),c.sc.suggestionHeight))if(t){var s=c.sc.scrollTop,l=t.getBoundingClientRect().top-c.sc.getBoundingClientRect().top;0<l+c.sc.suggestionHeight-c.sc.maxHeight?c.sc.scrollTop=l+c.sc.suggestionHeight+s-c.sc.maxHeight:l<0&&(c.sc.scrollTop=l+s)}else c.sc.scrollTop=0},i(window,"resize",c.updateSC),document.body.appendChild(c.sc),r("wb-autocomplete-suggestion","mouseleave",function(e){var t=c.sc.querySelector(".autocomplete-suggestion.selected");t&&setTimeout(function(){t.className=t.className.replace("selected","")},20)},c.sc),r("wb-autocomplete-suggestion","mouseover",function(e){var t=c.sc.querySelector(".wb-autocomplete-suggestion.selected");t&&(t.className=t.className.replace("selected","")),this.className+=" selected"},c.sc),r("wb-autocomplete-suggestion","mousedown",function(e){if(u(this,"wb-autocomplete-suggestion")){var t=this.getAttribute("data-val");c.value=t,n.onSelect(e,t,this),c.sc.style.display="none"}},c.sc),c.blurHandler=function(){try{var t=document.querySelector(".wb-autocomplete-suggestions:hover")}catch(e){t=0}t?c!==document.activeElement&&setTimeout(function(){c.focus()},20):(c.last_val=c.value,c.sc.style.display="none",setTimeout(function(){c.sc.style.display="none"},350))},i(c,"blur",c.blurHandler);var a=function(e){var t=c.value;if((c.cache[t]=e).length&&t.length>=n.minChars){for(var o="",s=0;s<e.length;s++)o+=n.renderItem(e[s],t);c.sc.innerHTML=o,c.updateSC(0)}else c.sc.style.display="none"};c.keydownHandler=function(e){var t,o=window.event?e.keyCode:e.which;if((40==o||38==o)&&c.sc.innerHTML)return(s=c.sc.querySelector(".wb-autocomplete-suggestion.selected"))?(t=40==o?s.nextSibling:s.previousSibling)?(s.className=s.className.replace("selected",""),t.className+=" selected",c.value=t.getAttribute("data-val")):(s.className=s.className.replace("selected",""),c.value=c.last_val,t=0):((t=40==o?c.sc.querySelector(".wb-autocomplete-suggestion"):c.sc.childNodes[c.sc.childNodes.length-1]).className+=" selected",c.value=t.getAttribute("data-val")),c.updateSC(0,t),!1;if(27==o)c.value=c.last_val,c.sc.style.display="none";else if(13==o||9==o){var s;(s=c.sc.querySelector(".wb-autocomplete-suggestion.selected"))&&"none"!=c.sc.style.display&&(n.onSelect(e,s.getAttribute("data-val"),s),setTimeout(function(){c.sc.style.display="none"},20))}},i(c,"keydown",c.keydownHandler),c.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(!t||(t<35||40<t)&&13!=t&&27!=t){var o=c.value;if(o.length>=n.minChars){if(o!=c.last_val){if(c.last_val=o,clearTimeout(c.timer),n.cache){if(o in c.cache)return void a(c.cache[o]);for(var s=1;s<o.length-n.minChars;s++){var l=o.slice(0,o.length-s);if(l in c.cache&&!c.cache[l].length)return void a([])}}c.timer=setTimeout(function(){n.source(o,a)},n.delay)}}else c.last_val=o,c.sc.style.display="none"}},i(c,"keyup",c.keyupHandler),c.focusHandler=function(e){c.last_val="\n",c.keyupHandler(e)},n.minChars||i(c,"focus",c.focusHandler)}this.destroy=function(){for(var e=0;e<o.length;e++){var t=o[e];l(window,"resize",t.updateSC),l(t,"blur",t.blurHandler),l(t,"focus",t.focusHandler),l(t,"keydown",t.keydownHandler),l(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}function u(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function i(e,t,o){e.attachEvent?e.attachEvent("on"+t,o):e.addEventListener(t,o)}function l(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener(t,o)}function r(s,e,l,t){i(t||document,e,function(e){for(var t,o=e.target||e.srcElement;o&&!(t=u(o,s));)o=o.parentElement;t&&l.call(o,e)})}};"function"==typeof define&&define.amd?define("wbAutoComplete",function(){return wbAutoComplete}):"undefined"!=typeof module&&module.exports?module.exports=wbAutoComplete:window.wbAutoComplete=wbAutoComplete;